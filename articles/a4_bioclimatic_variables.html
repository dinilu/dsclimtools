<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>4. Calculate bioclimatic variables and SDM â€¢ dsclimtools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="4. Calculate bioclimatic variables and SDM">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dsclimtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a1_dsclim_point_data.html">1. Use dsclim past data with point data</a></li>
    <li><a class="dropdown-item" href="../articles/a2_dsclim_past_to_future.html">2. Combine dsclim data from past to future</a></li>
    <li><a class="dropdown-item" href="../articles/a3_dsclim_maps.html">3. Analyse spatio-temporal patterns</a></li>
    <li><a class="dropdown-item" href="../articles/a4_bioclimatic_variables.html">4. Calculate bioclimatic variables and SDM</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dinilu/dsclimtools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>4. Calculate bioclimatic variables and SDM</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dinilu/dsclimtools/blob/master/vignettes/a4_bioclimatic_variables.Rmd" class="external-link"><code>vignettes/a4_bioclimatic_variables.Rmd</code></a></small>
      <div class="d-none name"><code>a4_bioclimatic_variables.Rmd</code></div>
    </div>

    
    
<p>It is standard practice in biogeography studies to derive new
variables from existing climatic data, as this makes it easier to
interpret the data ecologically. One example of this is the calculation
of bioclimate variables. Furthermore, these variables are typically
employed as inputs for ecological modelling tools, such as Species
Distribution Models (SDMs), which correlate them with species
occurrences to estimate potential distribution across an area of
interest. In this example, we have calculated a set of bioclimatic
variables for the specified study periods and used them to calibrate a
Species Distribution Model (SDM) which was projected into past
conditions.</p>
<div class="section level2">
<h2 id="dependencies-and-functions">Dependencies and functions<a class="anchor" aria-label="anchor" href="#dependencies-and-functions"></a>
</h2>
<p>In this step, we load the necessary packages and our own functions in
order to convert the star object to a raster stack (we transform our
data from cube format into a stack to use typicall functions of spatial
analysis ) and project the resulting model predictions into the
past.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dinilu/dsclimtools" class="external-link">dsclimtools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/stars/" class="external-link">stars</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster/sdm/" class="external-link">dismo</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gganimate.com" class="external-link">gganimate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">KnowBR</span><span class="op">)</span></span>
<span></span>
<span><span class="va">stars_to_stack</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span>, <span class="va">data</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="va">i</span><span class="op">:</span><span class="op">(</span><span class="va">i</span><span class="op">+</span><span class="fl">11</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu">rast</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">model.projection</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span>, <span class="va">predictors_list</span>, <span class="va">land</span>, <span class="va">model</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">predictors</span> <span class="op">&lt;-</span> <span class="va">predictors_list</span><span class="op">[[</span><span class="va">p</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                <span class="fu">raster</span><span class="fu">::</span><span class="fu">mask</span><span class="op">(</span><span class="va">land</span><span class="op">)</span></span>
<span>  <span class="va">prediction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">predictors</span>, </span>
<span>                        <span class="va">model</span>, </span>
<span>                        type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span>  <span class="va">prediction</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2 tabset tabset-pills">
<h2 class="tabset tabset-pills" id="period-selection">Period selection<a class="anchor" aria-label="anchor" href="#period-selection"></a>
</h2>
<p>In this section, we outline the periods of interest.</p>


<ul class="nav nav-pills" id="period-selection" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#present" id="present-tab" type="button" role="tab" aria-controls="present" aria-selected="true" class="active nav-link">Present</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#past" id="past-tab" type="button" role="tab" aria-controls="past" aria-selected="false" class="nav-link">Past</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="present" role="tabpanel" aria-labelledby="present-tab">

<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">present_start</span> <span class="op">&lt;-</span> <span class="fl">11</span></span>
<span><span class="va">present_end</span> <span class="op">&lt;-</span> <span class="fl">40</span></span></code></pre></div>
</div>
<div class="tab-pane" id="past" role="tabpanel" aria-labelledby="past-tab">

<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">past_start</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">14500</span></span>
<span><span class="va">past_end</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">14400</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2 tabset tabset-pills">
<h2 class="tabset tabset-pills" id="extraction-of-source-climatic-data">Extraction of source climatic data<a class="anchor" aria-label="anchor" href="#extraction-of-source-climatic-data"></a>
</h2>
<p>In this step, we load the climatic data for the specified period. The
data is transformed into a list using the stars_to_stack function, with
each element representing a raster stack of the twelve months in each
year.</p>


<ul class="nav nav-pills" id="extraction-of-source-climatic-data" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#present-1" id="present-1-tab" type="button" role="tab" aria-controls="present-1" aria-selected="true" class="active nav-link">Present</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#past-1" id="past-1-tab" type="button" role="tab" aria-controls="past-1" aria-selected="false" class="nav-link">Past</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="present-1" role="tabpanel" aria-labelledby="present-1-tab">

<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">present_tmax</span> <span class="op">&lt;-</span> <span class="fu">dsclimtools</span><span class="fu">::</span><span class="fu"><a href="../reference/read_dsclim.html">read_dsclim</a></span><span class="op">(</span> <span class="st">"../data/dsclim"</span>, </span>
<span>                                          <span class="st">"tasmax"</span>,</span>
<span>                                          <span class="va">present_start</span>, </span>
<span>                                          <span class="va">present_end</span>, </span>
<span>                                          calendar_dates <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                          proxy <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">present_tmin</span> <span class="op">&lt;-</span> <span class="fu">dsclimtools</span><span class="fu">::</span><span class="fu"><a href="../reference/read_dsclim.html">read_dsclim</a></span><span class="op">(</span> <span class="st">"../data/dsclim"</span>,</span>
<span>                                          <span class="st">"tasmin"</span>,</span>
<span>                                          <span class="va">present_start</span>, </span>
<span>                                          <span class="va">present_end</span>, </span>
<span>                                          calendar_dates <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                          proxy <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">present_prec</span> <span class="op">&lt;-</span> <span class="fu">dsclimtools</span><span class="fu">::</span><span class="fu"><a href="../reference/read_dsclim.html">read_dsclim</a></span><span class="op">(</span> <span class="st">"../data/dsclim"</span>, </span>
<span>                                          <span class="st">"pr"</span>,</span>
<span>                                          <span class="va">present_start</span>, </span>
<span>                                          <span class="va">present_end</span>, </span>
<span>                                          calendar_dates <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                          proxy <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">present_tmax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">360</span>, by <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>, </span>
<span>                       FUN <span class="op">=</span> <span class="va">stars_to_stack</span>, </span>
<span>                       <span class="va">present_tmax</span><span class="op">)</span></span>
<span></span>
<span><span class="va">present_tmin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">360</span>, by <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>, </span>
<span>                       FUN <span class="op">=</span> <span class="va">stars_to_stack</span>, </span>
<span>                       <span class="va">present_tmin</span><span class="op">)</span></span>
<span></span>
<span><span class="va">present_prec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">360</span>, by <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>                       FUN <span class="op">=</span> <span class="va">stars_to_stack</span>, </span>
<span>                       <span class="va">present_prec</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figures%2Fa4%2Fpresent_tmax.png" width="600" alt="Figure 1. Maximun Temperature"><div class="figcaption">Figure 1. Maximun Temperature</div>
</div>
</div>
<div class="tab-pane" id="past-1" role="tabpanel" aria-labelledby="past-1-tab">

<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmax</span> <span class="op">&lt;-</span> <span class="fu">dsclimtools</span><span class="fu">::</span><span class="fu"><a href="../reference/read_dsclim.html">read_dsclim</a></span><span class="op">(</span> <span class="st">"../data/dsclim"</span>, </span>
<span>                                  <span class="st">"tasmax"</span>,</span>
<span>                                  <span class="va">past_start</span>, </span>
<span>                                  <span class="va">past_end</span>, </span>
<span>                                  calendar_dates <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                  proxy <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmin</span> <span class="op">&lt;-</span> <span class="fu">dsclimtools</span><span class="fu">::</span><span class="fu"><a href="../reference/read_dsclim.html">read_dsclim</a></span><span class="op">(</span> <span class="st">"../data/dsclim"</span>, </span>
<span>                                  <span class="st">"tasmin"</span>,</span>
<span>                                  <span class="va">past_start</span>, </span>
<span>                                  <span class="va">past_end</span>, </span>
<span>                                  calendar_dates <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                  proxy <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">prec</span> <span class="op">&lt;-</span> <span class="fu">dsclimtools</span><span class="fu">::</span><span class="fu"><a href="../reference/read_dsclim.html">read_dsclim</a></span><span class="op">(</span> <span class="st">"../data/dsclim"</span>,</span>
<span>                                  <span class="st">"pr"</span>,</span>
<span>                                  <span class="va">past_start</span>, </span>
<span>                                  <span class="va">past_end</span>, </span>
<span>                                  calendar_dates <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                  proxy <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1212</span>, by <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>, </span>
<span>               FUN <span class="op">=</span> <span class="va">stars_to_stack</span>, </span>
<span>               <span class="va">tmax</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1212</span>, by <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>, </span>
<span>               FUN <span class="op">=</span> <span class="va">stars_to_stack</span>, </span>
<span>               <span class="va">tmin</span><span class="op">)</span></span>
<span></span>
<span><span class="va">prec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1212</span>, by <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>               FUN <span class="op">=</span> <span class="va">stars_to_stack</span>, </span>
<span>               <span class="va">prec</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figures%2Fa4%2Fpast_tmax.png" width="600" alt="Figure 2. Maximun Temperature"><div class="figcaption">Figure 2. Maximun Temperature</div>
</div>
</div>
</div>
</div>
<div class="section level2 tabset tabset-pills">
<h2 class="tabset tabset-pills" id="bioclimatic-variables-calculation">Bioclimatic variables calculation<a class="anchor" aria-label="anchor" href="#bioclimatic-variables-calculation"></a>
</h2>
<p>We have now calculated the 19 bioclimatic variables for the specified
periods of interest in accordance with the agreed specifications. The
data is stored in the form of a list, with each element representing a
raster stack of the 19 bioclimatic variables. Please note that for the
present period, the mean has been calculated in order to create a unique
grid for each variable, which will be used later in the model
calibration process. In both cases, we selected the variables that we
intend to use in our model. As this example has been developed based on
the guidance set out in <a href="https://rspatial.org/raster/sdm/raster_SDM.pdf" class="external-link uri">https://rspatial.org/raster/sdm/raster_SDM.pdf</a>, we have
maintained consistency in the bioclimatic variables used. It is
important to note that this is solely for illustrative purposes. In
actual modelling, it would be advisable to select variables based on
their ecological impact on the study species and their correlation.</p>


<ul class="nav nav-pills" id="bioclimatic-variables-calculation" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#present-2" id="present-2-tab" type="button" role="tab" aria-controls="present-2" aria-selected="true" class="active nav-link">Present</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#past-2" id="past-2-tab" type="button" role="tab" aria-controls="past-2" aria-selected="false" class="nav-link">Past</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="present-2" role="tabpanel" aria-labelledby="present-2-tab">

<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">present_bio_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="fu">dismo</span><span class="fu">::</span><span class="va">biovars</span>, </span>
<span>                           <span class="va">present_prec</span>, </span>
<span>                           <span class="va">present_tmin</span>, </span>
<span>                           <span class="va">present_tmax</span>,</span>
<span>                           SIMPLIFY <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Present_bioclim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="fu">reduce</span><span class="op">(</span><span class="va">present_bio_list</span>, <span class="va">`+`</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">present_bio_list</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">12</span>,<span class="fl">16</span>,<span class="fl">17</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="tab-pane" id="past-2" role="tabpanel" aria-labelledby="past-2-tab">

<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bio_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="fu">dismo</span><span class="fu">::</span><span class="va">biovars</span>, </span>
<span>                   <span class="va">prec</span>, </span>
<span>                   <span class="va">tmin</span>, </span>
<span>                   <span class="va">tmax</span>, </span>
<span>                   SIMPLIFY <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">12</span>,<span class="fl">16</span>,<span class="fl">17</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="sdm-data-preparation">SDM data preparation<a class="anchor" aria-label="anchor" href="#sdm-data-preparation"></a>
</h2>
<p>We have prepared the presence and absence data in order to run an
example of a species distribution model. Please note that we have loaded
a topography mask to ensure that all points are within the designated
land area. The pseudo-absences points were generated randomly. Once the
required data had been collated, we extracted the current values of the
selected variables for the specified locations.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Beetles"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">presences</span> <span class="op">&lt;-</span> <span class="va">Beetles</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"Bubas bison"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Longitude</span>, <span class="va">Latitude</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">topo14_mask</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, </span>
<span>                           <span class="st">"topo14_mask.tif"</span>, </span>
<span>                           package <span class="op">=</span> <span class="st">"dsclimtools"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>               <span class="fu">raster</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">absences</span> <span class="op">&lt;-</span> <span class="fu">randomPoints</span><span class="op">(</span><span class="va">topo14_mask</span>, </span>
<span>                         <span class="fl">400</span>, </span>
<span>                         <span class="va">presences</span><span class="op">)</span></span>
<span></span>
<span><span class="va">presvals</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu">extract</span><span class="op">(</span><span class="va">Present_bioclim</span>, </span>
<span>                            <span class="va">presences</span>, </span>
<span>                            na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">presvals</span> <span class="op">&lt;-</span>  <span class="va">presvals</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">presvals</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">absvals</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu">extract</span><span class="op">(</span><span class="va">Present_bioclim</span>, </span>
<span>                           <span class="va">absences</span>, </span>
<span>                           na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">absvals</span> <span class="op">&lt;-</span>  <span class="va">absvals</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">absvals</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">pb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">presvals</span><span class="op">)</span><span class="op">)</span>, </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">absvals</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sdmdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">pb</span>, </span>
<span>                            <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">presvals</span>, <span class="va">absvals</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="glm-calibration-and-projection">GLM calibration and projection<a class="anchor" aria-label="anchor" href="#glm-calibration-and-projection"></a>
</h2>
<p>We calibrated a Generalized Linear Model for our dataset in line with
the specified requirements. Moreover, we projected the model over
current conditions as well as the selected period conditions to
illustrate the value of our dataset in biogeographical history
studies.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">pb</span> <span class="op">~</span> <span class="va">bio1</span> <span class="op">+</span> <span class="va">bio5</span> <span class="op">+</span> <span class="va">bio6</span> <span class="op">+</span> <span class="va">bio7</span> <span class="op">+</span> <span class="va">bio8</span> <span class="op">+</span> <span class="va">bio12</span> <span class="op">+</span> <span class="va">bio16</span> <span class="op">+</span> <span class="va">bio17</span>, </span>
<span>              data<span class="op">=</span><span class="va">sdmdata</span>, </span>
<span>              family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">present_prediction</span> <span class="op">&lt;-</span> <span class="va">Present_bioclim</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                      <span class="fu">raster</span><span class="fu">::</span><span class="fu">mask</span><span class="op">(</span><span class="va">topo14_mask</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span>xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pred_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">101</span><span class="op">)</span>, </span>
<span>                    FUN <span class="op">=</span> <span class="va">model.projection</span>, </span>
<span>                    <span class="va">bio_list</span>, </span>
<span>                    <span class="va">topo14_mask</span>, </span>
<span>                    <span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pred_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14500</span><span class="op">:</span><span class="op">-</span><span class="fl">14400</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pred_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">pred_data</span>, </span>
<span>                    FUN <span class="op">=</span> <span class="va">as.data.frame</span>, </span>
<span>                    xy <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                    na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu">reshape2</span><span class="fu">::</span><span class="fu">melt</span><span class="op">(</span>id.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"layer"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">L1</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">pred_data</span><span class="op">$</span><span class="va">L1</span> <span class="op">&lt;-</span> <span class="va">pred_data</span><span class="op">$</span><span class="va">L1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                <span class="va">as.numeric</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                <span class="va">as.factor</span></span>
<span></span>
<span><span class="va">years_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14500</span>, <span class="op">-</span><span class="fl">14400</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">pred_data</span><span class="op">$</span><span class="va">year</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">years_list</span>, FUN<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html" class="external-link">last</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pred_data</span><span class="op">$</span><span class="va">year</span> <span class="op">&lt;-</span> <span class="va">pred_data</span><span class="op">$</span><span class="va">year</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                  <span class="va">as.character</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                  <span class="va">as.numeric</span></span></code></pre></div>
</div>
<div class="section level2 tabset tabset-pills">
<h2 class="tabset tabset-pills" id="plotting-the-data">Plotting the data<a class="anchor" aria-label="anchor" href="#plotting-the-data"></a>
</h2>
<p>Furthermore, we have provided a graphical illustration of the
fluctuations in the potential distribution of the species over the
specified period, as well as its current predicted distribution.
Additionally, we have calculated the pixel mean value and identified
those which have a mean value greater than 0.7, which we believe will be
of interest to those engaged in biogeographical studies such as the
identification of refugia.</p>



<ul class="nav nav-pills" id="plotting-the-data" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#current-predicted-distribution" id="current-predicted-distribution-tab" type="button" role="tab" aria-controls="current-predicted-distribution" aria-selected="true" class="active nav-link">Current predicted distribution</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#graphical-animation" id="graphical-animation-tab" type="button" role="tab" aria-controls="graphical-animation" aria-selected="false" class="nav-link">Graphical animation</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#thresholded-map" id="thresholded-map-tab" type="button" role="tab" aria-controls="thresholded-map" aria-selected="false" class="nav-link">Thresholded map</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="current-predicted-distribution" role="tabpanel" aria-labelledby="current-predicted-distribution-tab">

<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">present_prediction</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_raster</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, </span>
<span>                  y <span class="op">=</span> <span class="va">y</span>, </span>
<span>                  fill <span class="op">=</span> <span class="va">layer</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis_c</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.title.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>, </span>
<span>        axis.title.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<div class="float">
<img src="figures%2Fa4%2Fpresent_map.png" width="640" alt="Figure 3. Current Predicted Distribution"><div class="figcaption">Figure 3. Current Predicted Distribution</div>
</div>
</div>
<div class="tab-pane" id="graphical-animation" role="tabpanel" aria-labelledby="graphical-animation-tab">

<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span></span>
<span>  <span class="va">pred_data</span>, </span>
<span>  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">layer</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_raster</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis_c</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Year: {current_frame}"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.title.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>, </span>
<span>        axis.title.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>gganimate.dev_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">600</span>, </span>
<span>                                  height <span class="op">=</span> <span class="fl">400</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gganim</span> <span class="op">&lt;-</span> <span class="va">gg</span> <span class="op">+</span> </span>
<span>  <span class="fu">transition_manual</span><span class="op">(</span><span class="va">year</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">animate</span><span class="op">(</span><span class="va">gganim</span>, </span>
<span>        duration <span class="op">=</span> <span class="fl">60</span>, </span>
<span>        width <span class="op">=</span> <span class="fl">600</span>, </span>
<span>        height <span class="op">=</span> <span class="fl">400</span>, </span>
<span>        renderer <span class="op">=</span> <span class="fu">gifski_renderer</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figures%2Fa4%2Fglm_timeseries.gif" alt="Figure 4. SDM Animation"><div class="figcaption">Figure 4. SDM Animation</div>
</div>
</div>
<div class="tab-pane" id="thresholded-map" role="tabpanel" aria-labelledby="thresholded-map-tab">

<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mean_data</span> <span class="op">&lt;-</span> <span class="va">pred_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>mean_layer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">layer</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>th_layer <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">mean_layer</span> <span class="op">&gt;=</span> <span class="fl">0.7</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>                              <span class="va">mean_layer</span> <span class="op">&lt;</span> <span class="fl">0.7</span> <span class="op">~</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">mean_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_raster</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, </span>
<span>                  y <span class="op">=</span> <span class="va">y</span>, </span>
<span>                  fill <span class="op">=</span> <span class="va">th_layer</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis_c</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.title.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>, </span>
<span>        axis.title.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<div class="float">
<img src="figures%2Fa4%2Fth_map.png" width="631" alt="Figure 5. SDM over threshold"><div class="figcaption">Figure 5. SDM over threshold</div>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Diego Nieto-Lugilde, Daniel Romera-Romera.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>

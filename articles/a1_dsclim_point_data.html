<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="dsclimtools">
<title>1. Use dsclim past data with point data â€¢ dsclimtools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="1. Use dsclim past data with point data">
<meta property="og:description" content="dsclimtools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dsclimtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a1_dsclim_point_data.html">1. Use dsclim past data with point data</a>
    <a class="dropdown-item" href="../articles/a2_dsclim_past_to_future.html">2. Combine dsclim data from past to future</a>
    <a class="dropdown-item" href="../articles/a3_dsclim_maps.html">3. Analyse spatio-temporal patterns</a>
    <a class="dropdown-item" href="../articles/a4_bioclimatic_variables.html">4. Calculate bioclimatic variables</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dinilu/dsclimtools/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>1. Use dsclim past data with point data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dinilu/dsclimtools/blob/HEAD/vignettes/a1_dsclim_point_data.Rmd" class="external-link"><code>vignettes/a1_dsclim_point_data.Rmd</code></a></small>
      <div class="d-none name"><code>a1_dsclim_point_data.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="extracting-point-data-from-downscaled-climate-files-">Extracting point data from downscaled climate files.<a class="anchor" aria-label="anchor" href="#extracting-point-data-from-downscaled-climate-files-"></a>
</h2>
<p>Here we select the start and the end of our study period, and the
locations which we are interested in. We use these values to extract
information of our climate data. We also aggregate the data by ten years
to avoid an excess of fluctuation in our example plot.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dinilu/dsclimtools" class="external-link">dsclimtools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">22000</span></span>
<span><span class="va">end</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span></span>
<span><span class="va">agg.dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calendar_dates.html">calendar_dates</a></span><span class="op">(</span><span class="va">start</span>, <span class="va">end</span>, by <span class="op">=</span>  <span class="st">"10 year"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, long <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">41.5</span>, <span class="fl">42.8</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"long"</span>, <span class="st">"lat"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">dsclimtools</span><span class="fu">::</span><span class="fu"><a href="../reference/read_dsclim.html">read_dsclim</a></span><span class="op">(</span> <span class="st">"../../Output"</span>, <span class="st">"tas"</span>, <span class="va">start</span>, <span class="va">end</span>, calendar_dates <span class="op">=</span> <span class="cn">TRUE</span>, sf <span class="op">=</span> <span class="va">points</span>, proxy <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span>by <span class="op">=</span> <span class="va">agg.dates</span>, FUN <span class="op">=</span> <span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">figure</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">tas</span>, colour <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_text.html" class="external-link">st_as_text</a></span><span class="op">(</span><span class="va">geometry</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"f1"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">figure</span></span></code></pre></div>
<div class="figure">
<img src="figures/a1/a1_fig1_dsclim_data.png" alt=""><p class="caption">Figure 1. Mean decadal temperature as in the dsclim
dataset for two points</p>
</div>
</div>
<div class="section level2">
<h2 id="importing-trace21ka-data">Importing TraCE21ka data<a class="anchor" aria-label="anchor" href="#importing-trace21ka-data"></a>
</h2>
<p>Here we charge the TraCE21Ka pixel in which point 1 and point 2 are
included.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># datatrace &lt;- dsclimtools::read_trace("../../Data/TraCE21ka", "TS", point1) %&gt;% aggregate(by = agg.dates, FUN = mean, na.rm = TRUE)</span></span>
<span><span class="va">datatrace</span> <span class="op">&lt;-</span> <span class="fu">dsclimtools</span><span class="fu">::</span><span class="fu"><a href="../reference/read_trace.html">read_trace</a></span><span class="op">(</span><span class="st">"../../Data/TraCE21ka"</span>, <span class="st">"TS"</span>, <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_set_crs</a></span><span class="op">(</span><span class="va">points</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, <span class="fl">4326</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span>by <span class="op">=</span> <span class="va">agg.dates</span>, FUN <span class="op">=</span> <span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">figure</span> <span class="op">&lt;-</span> <span class="va">figure</span> <span class="op">+</span> <span class="fu">geom_line</span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">datatrace</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">TS</span>, colour <span class="op">=</span> <span class="st">"#000000"</span>, linetype <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">figure</span></span></code></pre></div>
<div class="figure">
<img src="figures/a1/a1_fig1_plus_trace_data.png" alt=""><p class="caption">Figure 2. Mean decadal temperature as in the dsclim
dataset for two points and mean decadal temperature as in the original
TraCE21ka dataset for the pixel including both points.</p>
</div>
</div>
<div class="section level2">
<h2 id="extracting-chelsa-point-data">Extracting CHELSA point data<a class="anchor" aria-label="anchor" href="#extracting-chelsa-point-data"></a>
</h2>
<p>Here we extract point data from CHELSA, in this case we charged on
the one hand maximum temperature and on the other hand minimun
temperature. Once we have their point data (and we have made some unit
conversion) we calculate average temperature.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chelsa_tmax</span> <span class="op">&lt;-</span> <span class="st">"../../Data/chelsa_trace/tasmax/CHELSA_TraCE21k_tasmax_"</span></span>
<span><span class="va">chelsa_tmin</span> <span class="op">&lt;-</span> <span class="st">"../../Data/chelsa_trace/tasmin/CHELSA_TraCE21k_tasmin_"</span></span>
<span></span>
<span><span class="va">pixel1</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="st">"../../10-Paper/02-Figure_timeseries_ds-chelsa/pixel1.gpkg"</span><span class="op">)</span></span>
<span><span class="va">pixel2</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="st">"../../10-Paper/02-Figure_timeseries_ds-chelsa/pixel2.gpkg"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, <span class="op">-</span><span class="fl">200</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">chelsa_tmax_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"../../Data/chelsa_trace/tasmax/CHELSA_TraCE21k_tasmax_"</span>, <span class="va">df</span><span class="op">$</span><span class="va">Var1</span>, <span class="st">"_"</span>, <span class="va">df</span><span class="op">$</span><span class="va">Var2</span>, <span class="st">"_V1.0.tif"</span><span class="op">)</span></span>
<span><span class="va">chelsa_tmin_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"../../Data/chelsa_trace/tasmin/CHELSA_TraCE21k_tasmin_"</span>, <span class="va">df</span><span class="op">$</span><span class="va">Var1</span>, <span class="st">"_"</span>, <span class="va">df</span><span class="op">$</span><span class="va">Var2</span>, <span class="st">"_V1.0.tif"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span> <span class="op">-</span><span class="fl">20100</span>, to<span class="op">=</span><span class="fl">1900</span>,  by<span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">chelsa_dates</span> <span class="op">&lt;-</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"0000-"</span>, <span class="va">df</span><span class="op">$</span><span class="va">Var1</span>, <span class="st">"-01"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">years</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Var2</span><span class="op">)</span></span>
<span>      </span>
<span><span class="va">chelsa_tmax_pixel1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/read_stars.html" class="external-link">read_stars</a></span><span class="op">(</span><span class="va">chelsa_tmax_files</span>, along <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/st_dimensions.html" class="external-link">st_set_dimensions</a></span><span class="op">(</span>which <span class="op">=</span> <span class="st">"time"</span>, values <span class="op">=</span> <span class="va">chelsa_dates</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span>by <span class="op">=</span> <span class="va">pixel1</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span><span class="va">chelsa_tmax_pixel1</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">chelsa_tmax_pixel1</span> <span class="op">*</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">-</span> <span class="fl">273</span><span class="op">)</span> </span>
<span>  </span>
<span><span class="va">chelsa_tmin_pixel1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/read_stars.html" class="external-link">read_stars</a></span><span class="op">(</span><span class="va">chelsa_tmin_files</span>, along <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/st_dimensions.html" class="external-link">st_set_dimensions</a></span><span class="op">(</span>which <span class="op">=</span> <span class="st">"time"</span>, values <span class="op">=</span> <span class="va">chelsa_dates</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span>by <span class="op">=</span> <span class="va">pixel1</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span><span class="va">chelsa_tmin_pixel1</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">chelsa_tmin_pixel1</span> <span class="op">*</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">-</span> <span class="fl">273</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chelsa1</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">chelsa_tmax_pixel1</span> <span class="op">+</span> <span class="va">chelsa_tmin_pixel1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="fu">dsclimtools</span><span class="fu">::</span><span class="fu"><a href="../reference/calendar_dates.html">calendar_dates</a></span><span class="op">(</span><span class="op">-</span><span class="fl">22050</span>, <span class="fl">40</span>, by <span class="op">=</span> <span class="st">"100 years"</span><span class="op">)</span>, FUN<span class="op">=</span><span class="va">mean</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">chelsa_tmax_pixel2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/read_stars.html" class="external-link">read_stars</a></span><span class="op">(</span><span class="va">chelsa_tmax_files</span>, along <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/st_dimensions.html" class="external-link">st_set_dimensions</a></span><span class="op">(</span>which <span class="op">=</span> <span class="st">"time"</span>, values <span class="op">=</span> <span class="va">chelsa_dates</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span>by <span class="op">=</span> <span class="va">pixel2</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span><span class="va">chelsa_tmax_pixel2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">chelsa_tmax_pixel2</span> <span class="op">*</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">-</span> <span class="fl">273</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">chelsa_tmin_pixel2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/read_stars.html" class="external-link">read_stars</a></span><span class="op">(</span><span class="va">chelsa_tmin_files</span>, along <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://r-spatial.github.io/stars/reference/st_dimensions.html" class="external-link">st_set_dimensions</a></span><span class="op">(</span>which <span class="op">=</span> <span class="st">"time"</span>, values <span class="op">=</span> <span class="va">chelsa_dates</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span>by <span class="op">=</span> <span class="va">pixel2</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span><span class="va">chelsa_tmin_pixel2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">chelsa_tmin_pixel2</span> <span class="op">*</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">-</span> <span class="fl">273</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chelsa2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">chelsa_tmax_pixel2</span> <span class="op">+</span> <span class="va">chelsa_tmin_pixel2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="fu">dsclimtools</span><span class="fu">::</span><span class="fu"><a href="../reference/calendar_dates.html">calendar_dates</a></span><span class="op">(</span><span class="op">-</span><span class="fl">22050</span>, <span class="fl">40</span>, by <span class="op">=</span> <span class="st">"100 years"</span><span class="op">)</span>, FUN<span class="op">=</span><span class="va">mean</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">figure</span> <span class="op">&lt;-</span> <span class="va">figure</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_step</span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">chelsa1</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">attr</span>, colour <span class="op">=</span> <span class="st">"POINT (0 41.5)"</span>, linetype <span class="op">=</span> <span class="st">"11"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_step</span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">chelsa2</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">attr</span>, colour <span class="op">=</span> <span class="st">"POINT (0 42.8)"</span>, linetype <span class="op">=</span> <span class="st">"11"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">figure</span></span></code></pre></div>
<div class="figure">
<img src="figures/a1/a1_fig1_plus_chelsatrace_data.png" alt=""><p class="caption">Figure 3. Mean decadal temperature as in the dsclim
dataset and chelsa-trace for two points, and mean decadal temperature as
in the original TraCE21ka dataset for the pixel including both
points.</p>
</div>
</div>
<div class="section level2">
<h2 id="plotting-the-data">Plotting the data<a class="anchor" aria-label="anchor" href="#plotting-the-data"></a>
</h2>
<p>Here we just plot all the data together to have a look of the
similarities and differences between the different sources.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">figure</span> <span class="op">+</span> </span>
<span>    <span class="fu">theme_light</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Surface Temperature (ÂºC)"</span>, x <span class="op">=</span> <span class="st">"Time (calendar years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"1950-01-01"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">years</a></span><span class="op">(</span><span class="op">-</span><span class="fl">21150</span><span class="op">)</span>, <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">years</a></span><span class="op">(</span><span class="fl">240</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    </span>
<span>    <span class="fu">scale_linetype_identity</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Data source"</span>,</span>
<span>                            breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"solid"</span>, <span class="st">"f1"</span>, <span class="st">"11"</span><span class="op">)</span>,</span>
<span>                            labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TraCE21ka"</span>, <span class="st">"dsclim"</span>, <span class="st">"Chelsa-TraCE"</span><span class="op">)</span>,</span>
<span>                            guide <span class="op">=</span> <span class="st">"legend"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>    <span class="fu">scale_color_manual</span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#000000"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span><span class="op">)</span>,</span>
<span>                       labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Trace pixel"</span>, <span class="st">"Point A"</span>, <span class="st">"Point B"</span><span class="op">)</span>,</span>
<span>                       guide <span class="op">=</span> <span class="st">"legend"</span>,</span>
<span>                       name <span class="op">=</span> <span class="st">"Location"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/a1/a1_fig1_arranged.png" alt=""><p class="caption">Figure 4. Figure 3 arranged to codify colors and
linetypes.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Diego Nieto-Lugilde, Daniel Romera-Romera.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
